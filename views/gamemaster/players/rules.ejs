<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= player.name %>'s Secret Rules</title>
    <link rel="stylesheet" href="/styles/main.css" />
</head>
<body>
    <%- include("../../partials/nav") %>
    <h1><%=player.name %>'s Secret Rules</h1>
    <ul>
        <% player.rules.forEach(rule => { %>
            <li>Rule <%= rule.number %></li>
            <li><%= rule.info %></li>
        <% }) %>
    </ul>
    <%let rulesLength = 0;%>
    <% rules.forEach(rule => { %>
        <%if(rule.isSecret){%>
            <% rulesLength++ %>
        <%}%>
    <%})%>
    <% if(rulesLength===0){%>
        <p>There are no rules to add!</p>
    <%} else{%>
    <form action="/gamemaster/players/<%=player._id%>/rules" method="POST">
        <select name="rule">
            <% let ruleExists = false; %>
            <% rules.forEach(rule => { %>
                <% player.rules.forEach(playerRule =>{%>
                    <% if(rule.number==playerRule.number){%>
                        <%console.log(rule.number + " " + playerRule.number);%>
                        <% ruleExists = true;%>
                    <%}%>
                <% }) %>
                <% if(!ruleExists){ %>
                    <% if(rule.isSecret){%>}
                        <option value="<%= rule._id %>"><%=rule.number%></option> 
                    <%}%>
                <% } %>
                <%ruleExists=false;%>
            <% }) %>
        </select>
        <input type="submit" value="Add New Rule">
    </form>
    <%}%>
</body>
</html>